<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>You Do Not Need a Plugin for This Feature - jdhao's digital space</title>
<meta name=renderer content="webkit">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1">
<meta http-equiv=cache-control content="no-transform">
<meta http-equiv=cache-control content="no-siteapp">
<meta name=theme-color content="#f8f5ec">
<meta name=msapplication-navbutton-color content="#f8f5ec">
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec">
<meta name=author content="jdhao"><meta name=description content="I saw from the repo awesome neovim1 a plugin that helps the user create the intermediate dir when they save a file. I wondered why this feature even needs a whole plugin? You can literally do this with a few lines of code.
"><meta name=keywords content="Hugo,theme,even">
<meta name=google-site-verification content="HTz0VHxqny_b0FfS774dICLBzHGBZCb_S11j_akF1Tw">
<meta name=generator content="Hugo 0.92.1 with theme even">
<link rel=canonical href=https://jdhao.github.io/2022/08/21/you-do-not-need-a-plugin-for-this/>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png>
<link rel=manifest href=/manifest.json>
<link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5>
<script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<meta name=referrer content="no-referrer-when-downgrade"><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-6058871559165202",enable_page_level_ads:!0})</script>
<script>var ezoicId=388800</script>
<script type=text/javascript src=//go.ezoic.net/ezoic/ezoic.js></script>
<link href=/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css rel=stylesheet>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous>
<meta property="og:title" content="You Do Not Need a Plugin for This Feature">
<meta property="og:description" content="I saw from the repo awesome neovim1 a plugin that helps the user create the intermediate dir when they save a file.
I wondered why this feature even needs a whole plugin?
You can literally do this with a few lines of code.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://jdhao.github.io/2022/08/21/you-do-not-need-a-plugin-for-this/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2022-08-21T11:56:35+08:00">
<meta property="article:modified_time" content="2022-09-12T18:37:31+08:00">
<meta itemprop=name content="You Do Not Need a Plugin for This Feature">
<meta itemprop=description content="I saw from the repo awesome neovim1 a plugin that helps the user create the intermediate dir when they save a file.
I wondered why this feature even needs a whole plugin?
You can literally do this with a few lines of code."><meta itemprop=datePublished content="2022-08-21T11:56:35+08:00">
<meta itemprop=dateModified content="2022-09-12T18:37:31+08:00">
<meta itemprop=wordCount content="422">
<meta itemprop=keywords content="plugin,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="You Do Not Need a Plugin for This Feature">
<meta name=twitter:description content="I saw from the repo awesome neovim1 a plugin that helps the user create the intermediate dir when they save a file.
I wondered why this feature even needs a whole plugin?
You can literally do this with a few lines of code."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]-->
</head>
<body>
<div id=mobile-navbar class=mobile-navbar>
<div class=mobile-header-logo>
<a href=/ class=logo>jdhao's digital space</a>
</div>
<div class=mobile-navbar-icon>
<span></span>
<span></span>
<span></span>
</div>
</div>
<nav id=mobile-menu class="mobile-menu slideout-menu">
<ul class=mobile-menu-list>
<a href=/>
<li class=mobile-menu-item>Home</li>
</a><a href=/post/>
<li class=mobile-menu-item>Archives</li>
</a><a href=/categories/>
<li class=mobile-menu-item>Categories</li>
</a><a href=/tags/>
<li class=mobile-menu-item>Tags</li>
</a><a href=/about/>
<li class=mobile-menu-item>About</li>
</a>
</ul>
</nav>
<div class=container id=mobile-panel>
<header id=header class=header>
<div class=logo-wrapper>
<a href=/ class=logo>jdhao's digital space</a>
</div>
<nav class=site-navbar>
<ul id=menu class=menu>
<li class=menu-item>
<a class=menu-item-link href=/>Home</a>
</li><li class=menu-item>
<a class=menu-item-link href=/post/>Archives</a>
</li><li class=menu-item>
<a class=menu-item-link href=/categories/>Categories</a>
</li><li class=menu-item>
<a class=menu-item-link href=/tags/>Tags</a>
</li><li class=menu-item>
<a class=menu-item-link href=/about/>About</a>
</li>
</ul>
</nav>
</header>
<main id=main class=main>
<div class=content-wrapper>
<div id=content class=content>
<article class=post>
<header class=post-header>
<h1 class=post-title>You Do Not Need a Plugin for This Feature</h1>
<div class=post-meta>
<span class=post-time> 2022-08-21 </span>
<div class=post-category>
<a href=/categories/Nvim/> Nvim </a>
</div>
<span class=more-meta> 422 words </span>
<span class=more-meta> 2 mins read </span>
<span id=busuanzi_container_page_pv class=more-meta> <span id=busuanzi_value_page_pv><img src=/img/spinner.svg alt=spinner.svg></span> times read </span>
</div>
</header>
<div class=post-toc id=post-toc>
<h2 class=post-toc-title>Contents</h2>
<div class=post-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#references>References</a></li>
</ul>
</nav>
</div>
</div>
<div class=post-content>
<p>I saw from the repo awesome neovim<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> a plugin that helps the user create the intermediate dir when they save a file.
I wondered why this feature even needs a whole plugin?
You can literally do this with a few lines of code.</p>
<p>Here is a similar Lua snippet from my own config<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=c1>-- Auto-create dir when saving a file, in case some intermediate directory does not exist</span>
<span class=kd>local</span> <span class=n>api</span> <span class=o>=</span> <span class=n>vim.api</span>

<span class=n>api.nvim_create_augroup</span><span class=p>(</span><span class=s2>&#34;auto_create_dir&#34;</span><span class=p>,</span> <span class=p>{</span>
  <span class=n>clear</span> <span class=o>=</span> <span class=kc>true</span>
<span class=p>})</span>

<span class=n>api.nvim_create_autocmd</span><span class=p>({</span> <span class=s2>&#34;BufWritePre&#34;</span> <span class=p>},</span> <span class=p>{</span>
  <span class=n>pattern</span> <span class=o>=</span> <span class=s2>&#34;*&#34;</span><span class=p>,</span>
  <span class=n>group</span> <span class=o>=</span> <span class=s2>&#34;auto_create_dir&#34;</span><span class=p>,</span>
  <span class=n>callback</span> <span class=o>=</span> <span class=kr>function</span><span class=p>()</span>
    <span class=kd>local</span> <span class=n>fpath</span> <span class=o>=</span> <span class=n>fn.expand</span><span class=p>(</span><span class=s1>&#39;&lt;afile&gt;&#39;</span><span class=p>)</span>
    <span class=kd>local</span> <span class=n>dir</span> <span class=o>=</span> <span class=n>fn.fnamemodify</span><span class=p>(</span><span class=n>fpath</span><span class=p>,</span> <span class=s2>&#34;:p:h&#34;</span><span class=p>)</span>

    <span class=c1>-- utils.may_create_dir(dir)</span>
    <span class=kd>local</span> <span class=n>res</span> <span class=o>=</span> <span class=n>fn.isdirectory</span><span class=p>(</span><span class=n>dir</span><span class=p>)</span>
    <span class=kr>if</span> <span class=n>res</span> <span class=o>==</span> <span class=mi>0</span> <span class=kr>then</span>
      <span class=n>fn.mkdir</span><span class=p>(</span><span class=n>dir</span><span class=p>,</span> <span class=s1>&#39;p&#39;</span><span class=p>)</span>
    <span class=kr>end</span>
  <span class=kr>end</span>
<span class=p>})</span>
</code></pre></div><p>This snippet is simple and do not require sophisticated knowledge to write.
You can write it perhaps after reading the <a href=https://github.com/nanotee/nvim-lua-guide>nvim lua guide</a>.
I do not think this is good for new users to learn how to use Neovim properly.
It creates unnecessary dependencies in their config for external plugins.
The extreme will be like the JavaScript world where there is dependency hell,
you rely on external libraries for even a small feature/function you do not care to write.
When that library fails/disappears, your library fails too, which is manifested in the famous <a href=https://www.davidhaney.io/npm-left-pad-have-we-forgotten-how-to-program/>left-pad incident</a>.</p>
<p>My philosophy is that if you can create a feature easily without external plugins,
try to write it yourself unless it will cost you a lot of effort, e.g.,
write a fully-featured git client for neovim (<a href=https://github.com/tpope/vim-fugitive>vim-fugitive</a> level).</p>
<p>I think as a neovim user, if you are serious about it, you got to learn some basic things.
Otherwise, you won&rsquo;t go long in this road.
In this sense, the hype over the pre-configuration is also doubtful.
Can the new user really learn something from these pre-configurations,
or are they just stuck in these pre-configurations, which may have their own config options?
My guess is that these configurations can not really help the new users learn the basics.</p>
<p>Edit: I posted this post on <a href=https://www.reddit.com/r/neovim/comments/wtqzi5/hey_you_do_not_need_a_plugin_for_this_feature/>reddit</a>, someone gives a <em>cleaner</em> way to do this:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=n>vim.api</span><span class=p>.</span><span class=n>nvim_create_autocmd</span><span class=p>({</span> <span class=s2>&#34;BufWritePre&#34;</span> <span class=p>},</span> <span class=p>{</span>
  <span class=n>pattern</span> <span class=o>=</span> <span class=s2>&#34;*&#34;</span><span class=p>,</span>
  <span class=n>group</span> <span class=o>=</span> <span class=n>vim.api</span><span class=p>.</span><span class=n>nvim_create_augroup</span><span class=p>(</span><span class=s2>&#34;auto_create_dir&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=n>clear</span> <span class=o>=</span> <span class=kc>true</span> <span class=p>}),</span>
  <span class=n>callback</span> <span class=o>=</span> <span class=kr>function</span><span class=p>(</span><span class=n>ctx</span><span class=p>)</span>
    <span class=kd>local</span> <span class=n>dir</span> <span class=o>=</span> <span class=n>vim.fn</span><span class=p>.</span><span class=n>fnamemodify</span><span class=p>(</span><span class=n>ctx.file</span><span class=p>,</span> <span class=s2>&#34;:p:h&#34;</span><span class=p>)</span>
    <span class=n>vim.fn</span><span class=p>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>dir</span><span class=p>,</span> <span class=s2>&#34;p&#34;</span><span class=p>)</span>
  <span class=kr>end</span>
<span class=p>})</span>
</code></pre></div><p>According to the <a href=https://neovim.io/doc/user/api.html#nvim_create_autocmd()>doc</a>, the callback accepts a table containing the context info.
The file path for the buffer where this autocmd is fired is in the <code>file</code> key.</p>
<h1 id=references>References</h1>
<ul>
<li>left-pad incident:
<ul>
<li><a href=https://www.theverge.com/2016/3/24/11300840/how-an-irate-developer-briefly-broke-javascript>https://www.theverge.com/2016/3/24/11300840/how-an-irate-developer-briefly-broke-javascript</a></li>
<li><a href=https://qz.com/646467/how-one-programmer-broke-the-internet-by-deleting-a-tiny-piece-of-code/>https://qz.com/646467/how-one-programmer-broke-the-internet-by-deleting-a-tiny-piece-of-code/</a></li>
<li><a href=https://www.reddit.com/r/programming/comments/4bjss2/an_11_line_npm_package_called_leftpad_with_only/>https://www.reddit.com/r/programming/comments/4bjss2/an_11_line_npm_package_called_leftpad_with_only/</a></li>
<li>A site made for left-pad: <a href=http://left-pad.io/>http://left-pad.io/</a></li>
<li><a href=https://medium.com/@digitalpublic/npm-azer-ko%C3%A7ulu-kik-and-the-law-f22742f099f6>https://medium.com/@digitalpublic/npm-azer-ko%C3%A7ulu-kik-and-the-law-f22742f099f6</a></li>
</ul>
</li>
</ul>
<section class=footnotes role=doc-endnotes>
<hr>
<ol>
<li id=fn:1 role=doc-endnote>
<p><a href=https://github.com/rockerBOO/awesome-neovim>https://github.com/rockerBOO/awesome-neovim</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
<li id=fn:2 role=doc-endnote>
<p>Modified a bit to make it self-running, original <a href=https://github.com/jdhao/nvim-config/blob/78baf8d015695c2b795ac6f955550f5e96104845/lua/custom-autocmd.lua#L53-L67>here</a>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
</ol>
</section>
</div>
<div class=post-copyright>
<p class=copyright-item>
<span class=item-title>Author</span>
<span class=item-content>jdhao</span>
</p>
<p class=copyright-item>
<span class=item-title>LastMod</span>
<span class=item-content>
2022-09-12
</span>
</p>
<p class=copyright-item>
<span class=item-title>License</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span>
</p>
</div>
<footer class=post-footer>
<div class=post-tags>
<a href=/tags/plugin/>plugin</a>
</div>
<nav class=post-nav>
<a class=prev href=/2022/09/04/cost-of-living-shenzhen/>
<i class="iconfont icon-left"></i>
<span class="prev-text nav-default">Cost of Living in Shenzhen</span>
<span class="prev-text nav-mobile">Prev</span>
</a>
<a class=next href=/2022/08/20/ctrl-left-right-not-work-mac/>
<span class="next-text nav-default">Ctrl-left and Ctrl-right Not Working in macOS?</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i>
</a>
</nav>
</footer>
</article>
</div>
<script src=https://utteranc.es/client.js repo=jdhao/jdhao.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script>
<noscript>Please enable JavaScript to view the <a href=https://github.com/utterance>comments powered by utterances.</a></noscript>
</div>
</main>
<footer id=footer class=footer>
<div class=social-links>
<a href=mailto:jdhao@hotmail.com class="iconfont icon-email" title=email></a>
<a href="https://stackoverflow.com/users/6064933/jdhao?tab=profile" class="iconfont icon-stack-overflow" title=stack-overflow></a>
<a href=https://github.com/jdhao class="iconfont icon-github" title=github></a>
<a href=https://jdhao.github.io/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a>
</div>
<div class=copyright>
<span class=power-by>
Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a>
</span>
<span class=division>|</span>
<span class=theme-info>
Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a>
</span>
<div class=busuanzi-footer>
<span id=busuanzi_container_site_pv> site pv: <span id=busuanzi_value_site_pv><img src=/img/spinner.svg alt=spinner.svg></span> </span>
<span class=division>|</span>
<span id=busuanzi_container_site_uv> site uv: <span id=busuanzi_value_site_uv><img src=/img/spinner.svg alt=spinner.svg></span> </span>
</div>
<span class=copyright-year>
&copy;
2017 -
2022<span class=heart><i class="iconfont icon-heart"></i></span><span>jdhao</span>
</span>
</div>
</footer>
<div class=back-to-top id=back-to-top>
<i class="iconfont icon-up"></i>
</div>
</div>
<script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js></script>
<script type=text/javascript>window.MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],tags:'ams'}}</script>
<script async src=https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-113395108-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<script id=baidu_push>(function(){var a,c,b;if(window.location.hostname==='localhost')return;a=document.createElement('script'),a.async=!0,c=window.location.protocol.split(':')[0],c==='https'?a.src='https://zz.bdstatic.com/linksubmit/push.js':a.src='http://push.zhanzhang.baidu.com/push.js',b=document.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b)})()</script>
</body>
</html>