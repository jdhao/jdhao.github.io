<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Configuring Ultisnips for Neovim - jdhao's blog</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="jdhao"><meta name=description content="If you have used Sublime Text before, you may be familiar with its snippet feature. Snippets let us type a trigger word and expand it to some boilerplate code or texts that we do not want to repeat typing. We will increase our efficiency dramatically with the help of snippets."><meta name=keywords content="Hugo,theme,even"><meta name=google-site-verification content="HTz0VHxqny_b0FfS774dICLBzHGBZCb_S11j_akF1Tw"><meta name=generator content="Hugo 0.75.1 with theme even"><link rel=canonical href=https://jdhao.github.io/2019/04/17/neovim_snippet_s1/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta name=referrer content="no-referrer-when-downgrade"><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-6058871559165202",enable_page_level_ads:true});</script><link href=/sass/main.min.2e81bbed97b8b282c1aeb57488cc71c8d8c8ec559f3931531bd396bf31e0d4dd.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:title" content="Configuring Ultisnips for Neovim"><meta property="og:description" content="If you have used Sublime Text before, you may be familiar with its
snippet feature.
Snippets let us type a
trigger word and expand it to some boilerplate code or texts that we do not
want to repeat typing. We will increase our efficiency dramatically with the
help of snippets."><meta property="og:type" content="article"><meta property="og:url" content="https://jdhao.github.io/2019/04/17/neovim_snippet_s1/"><meta property="article:published_time" content="2019-04-17T00:28:45+08:00"><meta property="article:modified_time" content="2020-05-28T00:21:56+08:00"><meta itemprop=name content="Configuring Ultisnips for Neovim"><meta itemprop=description content="If you have used Sublime Text before, you may be familiar with its
snippet feature.
Snippets let us type a
trigger word and expand it to some boilerplate code or texts that we do not
want to repeat typing. We will increase our efficiency dramatically with the
help of snippets."><meta itemprop=datePublished content="2019-04-17T00:28:45+08:00"><meta itemprop=dateModified content="2020-05-28T00:21:56+08:00"><meta itemprop=wordCount content="958"><meta itemprop=keywords content="snippet,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Configuring Ultisnips for Neovim"><meta name=twitter:description content="If you have used Sublime Text before, you may be familiar with its
snippet feature.
Snippets let us type a
trigger word and expand it to some boilerplate code or texts that we do not
want to repeat typing. We will increase our efficiency dramatically with the
help of snippets."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>jdhao's blog</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Home</li></a><a href=/post/><li class=mobile-menu-item>Archives</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a><a href=/categories/><li class=mobile-menu-item>Categories</li></a><a href=/about/><li class=mobile-menu-item>About</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>jdhao's blog</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=/categories/>Categories</a></li><li class=menu-item><a class=menu-item-link href=/about/>About</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Configuring Ultisnips for Neovim</h1><div class=post-meta><span class=post-time>2019-04-17</span><div class=post-category><a href=/categories/Nvim/>Nvim</a></div><span class=more-meta>958 words</span>
<span class=more-meta>5 mins read</span>
<span id=busuanzi_container_page_pv class=more-meta><span id=busuanzi_value_page_pv><img src=/img/spinner.svg alt=spinner.svg></span> times read</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class=post-toc-content><nav id=TableOfContents><ul><li><a href=#install>Install</a></li><li><a href=#how-to-use>How to use</a></li><li><a href=#how-to-use-your-own-snippets>How to use your own snippets</a><ul><li><a href=#where-to-store-my-custom-snippets>Where to store my custom snippets?</a></li><li><a href=#a-common-error-to-avoid>A common error to avoid</a></li></ul></li><li><a href=#references>References</a></li></ul></nav></div></div><div class=post-content><p>If you have used Sublime Text before, you may be familiar with its
<a href=http://sublimetext.info/docs/en/extensibility/snippets.html>snippet</a> feature.
<a href=https://en.wikipedia.org/wiki/Snippet_(programming)>Snippets</a> let us type a
trigger word and expand it to some boilerplate code or texts that we do not
want to repeat typing. We will increase our efficiency dramatically with the
help of snippets.</p><p>Several snippet plugins are available for Vim/Neovim:
<a href=https://github.com/garbas/vim-snipmate>snipmate</a>, <a href=https://github.com/Shougo/neosnippet.vim>neosnippet</a> and
<a href=https://github.com/SirVer/ultisnips>ultisnips</a> etc. All these plugins are
good enough for simple use cases. If you don&rsquo;t know which one to use, just try
ultisnips. In this post, I would like to share how to configure ultisnips and
use your own snippets in Neovim.</p><h1 id=install>Install</h1><p>In fact, ultisnips is just a snippet engine. To use the real snippets, you also
need to install <a href=https://github.com/honza/vim-snippets>vim-snippets</a>, which
provides a comprehensive list of snippets for various filetypes. You can
install the two plugins with your favorite plugin manager.</p><p>Ultisnips integrates automatically with the auto-completion engine
<a href=https://github.com/Shougo/deoplete.nvim>deoplete</a>. If you have installed
deoplete, you will see the auto-completion menu for your snippet keywords
without any settings.</p><p>The minimum settings for ultisnips are:</p><div class=highlight><pre class=chroma><code class=language-vim data-lang=vim><span class=c>&#34; Trigger configuration. Do not use &lt;tab&gt; if you use</span><span class=err>
</span><span class=err></span><span class=c>&#34; https://github.com/Valloric/YouCompleteMe.</span><span class=err>
</span><span class=err></span><span class=k>let</span> <span class=nx>g</span>:<span class=nx>UltiSnipsExpandTrigger</span><span class=p>=</span><span class=s1>&#39;&lt;tab&gt;&#39;</span><span class=err>
</span><span class=err></span><span class=c>
</span><span class=c>&#34; shortcut to go to next position</span><span class=err>
</span><span class=err></span><span class=k>let</span> <span class=nx>g</span>:<span class=nx>UltiSnipsJumpForwardTrigger</span><span class=p>=</span><span class=s1>&#39;&lt;c-j&gt;&#39;</span><span class=err>
</span><span class=err></span><span class=c>
</span><span class=c>&#34; shortcut to go to previous position</span><span class=err>
</span><span class=err></span><span class=k>let</span> <span class=nx>g</span>:<span class=nx>UltiSnipsJumpBackwardTrigger</span><span class=p>=</span><span class=s1>&#39;&lt;c-k&gt;&#39;</span><span class=err>
</span></code></pre></div><p>In the above setting, we set the trigger key to <kbd>Tab</kbd>, i.e., after
typing the trigger word for a snippet, we can then press <kbd>Tab</kbd> to
trigger snippet expansion. We may define several positions (these positions may
optionally contains placeholder texts) in a snippet, which are called tabstops
by Ultisnips. In the above settings, <code>Ctrl-J</code> and <code>Ctrl-K</code> are used to jump
forward and backward in these tabstops.</p><h1 id=how-to-use>How to use</h1><p>All the snippets provided by vim-snippets can be found
<a href=https://github.com/honza/vim-snippets/tree/master/UltiSnips>here</a>. The
snippet file for filetype <code>FOO</code> has name <code>FOO.snippets</code>, e.g., for python, the
snippet file is <code>python.snippets</code>. Filetype snippets are only available for the
specific file types. There is also a special snippet file named <code>all.snippets</code>,
which means that snippets inside are available for all file types.</p><p>A snippet has the following form:</p><div class=highlight><pre class=chroma><code class=language-vim data-lang=vim><span class=nx>snippet</span> <span class=nx>KEYWORD</span> <span class=s2>&#34;some description&#34;</span> [<span class=nx>FLAG</span>]<span class=err>
</span><span class=err>
</span><span class=err></span><span class=nx>snippet</span> <span class=nx>body</span>...<span class=err>
</span><span class=err>
</span><span class=err></span><span class=nx>endsnippet</span><span class=err>
</span></code></pre></div><p>, where <code>KEYWORD</code> is the trigger for the snippet. If you type <code>KEYWORD</code> and
press the trigger key, it will be expanded to the snippet body.</p><p>For example, there is a <code>date</code> keyword in <code>all.snippets</code>, if you type <code>date</code>,
and then press <kbd>Tab</kbd>, it will be expanded to the current date.</p><p align=center><img src=https://blog-resource-1257868508.file.myqcloud.com/date_snippet.gif></p><h1 id=how-to-use-your-own-snippets>How to use your own snippets</h1><p>It is easy to write a simple snippet. For example, to create a <a href=https://developer.mozilla.org/en-US/docs/Web/HTML/Element/kbd>kbd tag</a>
quickly when writing Markdown files, we can create a snippet for it. Here is
how to do it.</p><p>First, create a file named <code>markdown.snippets</code> and add the following content:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>snippet kbd &#34;HTML kbd tag&#34;
&lt;kbd&gt;$1&lt;/kbd&gt;
endsnippet
</code></pre></div><p>This will create a snippet named <code>kbd</code> for filetype markdown.</p><h2 id=where-to-store-my-custom-snippets>Where to store my custom snippets?</h2><p>After creating the snippet file, we should put it in a directory where
ultisnips can find it. This is a little tricky for Neovim.</p><p>The documentation of UltiSnips has explained how the snippet files are searched
(see <code>:h UltiSnips-how-snippets-are-loaded</code>). However, it is still not crystal
clear how to configure so that our custom snippets can be found by UltiSnips.</p><p>From the documentation of UltiSnips:</p><blockquote><p>UltiSnips will search each &lsquo;runtimepath&rsquo; directory for the subdirectory names
defined in g:UltiSnipsSnippetDirectories in the order they are defined. For
example, if you keep your snippets in <code>~/.vim/mycoolsnippets</code>and you want to
make use of the UltiSnips snippets that come with other plugins, add the
following to your vimrc file.</p><blockquote><p>let g:UltiSnipsSnippetDirectories=[&ldquo;UltiSnips&rdquo;, &ldquo;mycoolsnippets&rdquo;]</p></blockquote></blockquote><p>The description above is both informative and confusing since it is written for
Vim users, not Neovim users. Because the Neovim config file follows the <a href=https://wiki.archlinux.org/index.php/XDG_Base_Directory>XDG
Base Directory specification</a>
and is stored under <code>$HOME/.config/nvim</code>, not <code>$HOME/.vim</code>! As a result, if you
follow the above example, you will find that your custom snippets are not
available.</p><p>In the following, I will summarize what is working for <strong>Neovim</strong>.</p><p>First, open nvim and use the command <code>:echo &runtimepath</code>. This command will
print all the runtime paths that Neovim will search. According to the
documentation, your custom snippets directory should be put under one of these
runtime paths. On my Windows machine, the output is like (the full output is
omitted for brevity):</p><blockquote><p>C:\Users\Administrator\AppData\Local\nvim,C:\Users\Administrator\AppData\Local\nvim\plugged\deoplete.nvim,C:\Users\Administrator\AppData\Local\nvim\plugged\deoplete-jedi,C:\Users\Administrator\AppData\Local\nvim\plugged\neco-vim,&mldr;..</p></blockquote><p>On my Linux machine, the output is like (the full output is omitted):</p><blockquote><p>/home/jdhao/.config/nvim,/home/jdhao/.local/share/nvim/plugged/deoplete.nvim/,/home/jdhao/.local/share/nvim/plugged/deoplete-jedi/,/home/jdhao/.local/share/nvim/plugged/jedi-vim/,&mldr;..</p></blockquote><p>Different runtime paths are separated by a comma. The steps of configuring
custom snippets are the same for both Windows and Linux. So in the following
part, I will only focus on Linux since it is more popular.</p><p>One of the runtime paths on Linux is <code>/home/jdhao/.config/nvim</code>. This directory
is where the neovim config file <code>init.vim</code><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> is stored. We choose this
directory and create a folder named <code>my_snippets</code> under it. Then move the
<code>markdown.snippets</code> file into this folder<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>mkdir -p <span class=nv>$HOME</span>/.config/nvim/my_snippets
mv markdown.snippets <span class=nv>$HOME</span>/.config/nvim/my_snippets
</code></pre></div><p>In the third step, we add the following setting to <code>init.vim</code>:</p><div class=highlight><pre class=chroma><code class=language-vim data-lang=vim><span class=c>&#34; `my_snippets` is the directory we created before</span><span class=err>
</span><span class=err></span><span class=k>let</span> <span class=nx>g</span>:<span class=nx>UltiSnipsSnippetDirectories</span><span class=p>=</span>[<span class=s2>&#34;UltiSnips&#34;</span><span class=p>,</span> <span class=s2>&#34;my_snippets&#34;</span>]<span class=err>
</span></code></pre></div><p>Now, open a Markdown file and start typing <code>kbd</code> and you should be able to see
the <code>kbd</code> auto-complete item:</p><p align=center><img src=https://blog-resource-1257868508.file.myqcloud.com/20190421181446.png></p><p>The completion engine I am using is deoplete and <code>US</code> means that this
completion item is from UltiSnips.</p><h2 id=a-common-error-to-avoid>A common error to avoid</h2><p>You may have write your own snippet for a filetype and put it under the custom
snippet directory. However, the snippet does not seem to work.</p><p>One reason for this is that <strong>you have used the wrong name</strong> for the filetype.
For example, for LaTeX, the filetype is actually <code>tex</code>. So you need to create a
file named <code>tex.snippets</code>, <strong>not</strong> <code>latex.snippets</code> under your custom snippet
directory.</p><h1 id=references>References</h1><ul><li><a href=https://castel.dev/post/lecture-notes-1/>https://castel.dev/post/lecture-notes-1/</a></li><li><a href=https://github.com/SirVer/ultisnips/issues/830>https://github.com/SirVer/ultisnips/issues/830</a></li><li><a href=https://vi.stackexchange.com/q/7466/15292>Difference between different snippet plugins</a>.</li></ul><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>To check the location of this directory for your computer, use command <code>:echo stdpath('config')</code> inside Neovim. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>You can find all my snippets <a href=https://github.com/jdhao/nvim-config/tree/master/my_snippets>here</a>. <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div><div class=post-copyright><p class=copyright-item><span class=item-title>Author</span>
<span class=item-content>jdhao</span></p><p class=copyright-item><span class=item-title>LastMod</span>
<span class=item-content>2020-05-28</span></p><p class=copyright-item><span class=item-title>License</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span></p></div><div class=post-reward><input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>Reward</label><div class=qr-code><label class=qr-code-image for=reward><img class=image src=https://blog-resource-1257868508.file.myqcloud.com/wechat.png>
<span>wechat</span></label>
<label class=qr-code-image for=reward><img class=image src=https://blog-resource-1257868508.file.myqcloud.com/zhifubao.jpg>
<span>alipay</span></label></div></div><footer class=post-footer><div class=post-tags><a href=/tags/snippet/>snippet</a></div><nav class=post-nav><a class=prev href=/2019/04/17/nifty_nvim_techniques_s2/><i class="iconfont icon-left"></i><span class="prev-text nav-default">Nifty Little Nvim Techniques to Make My Life Easier -- Series 2</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=/2019/04/02/mac_logitech_mouse_setting/><span class="next-text nav-default">Mac 上罗技 M590 鼠标设置</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div><script src=https://utteranc.es/client.js repo=jdhao/jdhao.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script><noscript>Please enable JavaScript to view the <a href=https://github.com/utterance>comments powered by utterances.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href="https://stackoverflow.com/users/6064933/jdhao?tab=profile" class="iconfont icon-stack-overflow" title=stack-overflow></a><a href=https://github.com/jdhao class="iconfont icon-github" title=github></a><a href=https://jdhao.github.io/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span><div class=busuanzi-footer><span id=busuanzi_container_site_pv>site pv: <span id=busuanzi_value_site_pv><img src=/img/spinner.svg alt=spinner.svg></span></span>
<span class=division>|</span>
<span id=busuanzi_container_site_uv>site uv: <span id=busuanzi_value_site_uv><img src=/img/spinner.svg alt=spinner.svg></span></span></div><span class=copyright-year>&copy;
2017 -
2021<span class=heart><i class="iconfont icon-heart"></i></span><span>jdhao</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js></script><script type=text/javascript>window.MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],tags:'ams',}};</script><script async src=https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin=anonymous></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-113395108-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script id=baidu_push>(function(){if(window.location.hostname==='localhost')return;var bp=document.createElement('script');bp.async=true;var curProtocol=window.location.protocol.split(':')[0];if(curProtocol==='https'){bp.src='https://zz.bdstatic.com/linksubmit/push.js';}
else{bp.src='http://push.zhanzhang.baidu.com/push.js';}
var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script></body></html>