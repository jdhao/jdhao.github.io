<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Creating Markdown Front Matter with Ultisnips - jdhao's blog</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="jdhao"><meta name=description content="Introduction I write my blog posts in Markdown and build the blog using Hugo. Hugo supports front matter for Markdown so that you can attach some metadata with a post, such as title, date, tags, categories, etc."><meta name=keywords content="Hugo,theme,even"><meta name=google-site-verification content="HTz0VHxqny_b0FfS774dICLBzHGBZCb_S11j_akF1Tw"><meta name=generator content="Hugo 0.75.1 with theme even"><link rel=canonical href=https://jdhao.github.io/2019/12/22/ultisnips_avoid_content_update/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-6058871559165202",enable_page_level_ads:true});</script><link href=/sass/main.min.c7bc1becf36bcf6a9ebd25d2947e43a2eb745ddb0c9a32b43126fd7fa460c351.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:title" content="Creating Markdown Front Matter with Ultisnips"><meta property="og:description" content="Introduction
I write my blog posts in Markdown and build the blog using
Hugo. Hugo supports front matter
for Markdown so that you can attach some metadata with a post, such as title,
date, tags, categories, etc."><meta property="og:type" content="article"><meta property="og:url" content="https://jdhao.github.io/2019/12/22/ultisnips_avoid_content_update/"><meta property="article:published_time" content="2019-12-22T13:45:25+08:00"><meta property="article:modified_time" content="2020-04-25T20:56:35+08:00"><meta itemprop=name content="Creating Markdown Front Matter with Ultisnips"><meta itemprop=description content="Introduction
I write my blog posts in Markdown and build the blog using
Hugo. Hugo supports front matter
for Markdown so that you can attach some metadata with a post, such as title,
date, tags, categories, etc."><meta itemprop=datePublished content="2019-12-22T13:45:25+08:00"><meta itemprop=dateModified content="2020-04-25T20:56:35+08:00"><meta itemprop=wordCount content="523"><meta itemprop=keywords content="Vim,Markdown,snippet,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Creating Markdown Front Matter with Ultisnips"><meta name=twitter:description content="Introduction
I write my blog posts in Markdown and build the blog using
Hugo. Hugo supports front matter
for Markdown so that you can attach some metadata with a post, such as title,
date, tags, categories, etc."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>jdhao's blog</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Home</li></a><a href=/post/><li class=mobile-menu-item>Archives</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a><a href=/categories/><li class=mobile-menu-item>Categories</li></a><a href=/about/><li class=mobile-menu-item>About</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>jdhao's blog</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=/categories/>Categories</a></li><li class=menu-item><a class=menu-item-link href=/about/>About</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Creating Markdown Front Matter with Ultisnips</h1><div class=post-meta><span class=post-time>2019-12-22</span><div class=post-category><a href=/categories/Nvim/>Nvim</a></div><span class=more-meta>523 words</span>
<span class=more-meta>3 mins read</span>
<span id=busuanzi_container_page_pv class=more-meta><span id=busuanzi_value_page_pv><img src=/img/spinner.svg alt=spinner.svg></span> times read</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class=post-toc-content><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#initial-snippet>Initial snippet</a></li><li><a href=#ultisnips-command-interpolation>Ultisnips command interpolation</a><ul><li><a href=#vim-interpolation>Vim interpolation</a></li><li><a href=#python-interpolation>Python interpolation</a></li></ul></li><li><a href=#references>References</a></li></ul></nav></div></div><div class=post-content><h1 id=introduction>Introduction</h1><p>I write my blog posts in Markdown and build the blog using
<a href=https://gohugo.io/>Hugo</a>. Hugo supports <a href=https://gohugo.io/content-management/front-matter/>front matter</a>
for Markdown so that you can attach some metadata with a post, such as title,
date, tags, categories, etc.</p><p>The front matter for a post is something like the following:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nn>---</span><span class=w>
</span><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Creating Markdown Front Matter with Ultisnips&#34;</span><span class=w>
</span><span class=w></span><span class=nt>date</span><span class=p>:</span><span class=w> </span><span class=ld>2019-12-22 13:45:25</span><span class=m>+0800</span><span class=w>
</span><span class=w></span><span class=nt>tags</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>Vim, Markdown]</span><span class=w>
</span><span class=w></span><span class=nt>categories</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>Nvim]</span><span class=w>
</span><span class=w></span><span class=nn>---</span><span class=w>
</span></code></pre></div><p>The <code>date</code> field is in ISO date format.</p><h1 id=initial-snippet>Initial snippet</h1><p>It is tedious to write the boilerplate text in front matter for every post I
create. <a href=https://github.com/SirVer/ultisnips>Ultisnips</a> is good at automating
such tasks. If you are not familiar with Ultisnips, you can check <a href=https://jdhao.github.io/2019/04/17/neovim_snippet_s1/>my previous
post</a> on setting up
Ultisnips.</p><p>So the initial snippet I wrote looks like this:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nn>---</span><span class=w>
</span><span class=w></span><span class=l>snippet meta &#34;Markdown front matter in YAML format&#34; b</span><span class=w>
</span><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;${1:TITLE TEXT}&#34;</span><span class=w>
</span><span class=w></span><span class=nt>date</span><span class=p>:</span><span class=w> </span><span class=l>$2</span><span class=w>
</span><span class=w></span><span class=nt>tags</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>$3]</span><span class=w>
</span><span class=w></span><span class=nt>categories</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>$4]</span><span class=w>
</span><span class=w></span><span class=nn>---</span><span class=w>
</span></code></pre></div><p>When we type the trigger word <code>meta</code> at the beginning of a line<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> and press
<kbd>Tab</kbd>, it will be expanded. We can jump forward and backward among the
tabstops to fill the text.</p><p>This snippet is working great, but for the <code>date</code> field, we still need to fill
the current date manually, which is not convenient enough.</p><h1 id=ultisnips-command-interpolation>Ultisnips command interpolation</h1><p>Ultisnips also provides a powerful feature called interpolation, which means
that you can run shell, Vim and Python command inside a snippet and use the
returned output in snippet. The interpolation code are placed inside two
backticks (<code>`CODE`</code>) and opens up many possibilities. For shell command
interpolation, you just write the shell command inside the backticks. For Vim
and Python code interpolation, you should follow the opening backtick with <code>!v</code>
and <code>!p</code> respectively.</p><p>For example, to get the current date in ISO format, i.e., <code>2019-12-22 14:43:43+0800</code>, using the above three interpolation, the code is like:</p><ul><li>shell interpolation: <code>`date "+%Y-%m-%d %H:%M:%S%z"`</code></li><li>Vim interpolation: <code>`!v strftime("%Y-%m-%d %H:%M:%S%z")`</code></li><li>Python interpolation:<div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>`!p from datetime import datetime
snip.rv=datetime.now().strftime(&#34;%Y-%m-%d %H:%M:%S%z&#34;)`
</code></pre></div></li></ul><p>Back to the above snippet, if we want the interpolation code to be
cross-platform, we should only consider Vim or Python interpolation since most
Linux shell commands are not available on Windows.</p><h2 id=vim-interpolation>Vim interpolation</h2><p>With Vim interpolation, the original meta snippet for Markdown becomes:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=l>snippet &#34;meta(data)?&#34; &#34;Markdown metadata front matter&#34; br</span><span class=w>
</span><span class=w></span><span class=nn>---</span><span class=w>
</span><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;$1&#34;</span><span class=w>
</span><span class=w></span><span class=nt>date</span><span class=p>:</span><span class=w> </span><span class=l>`!v strftime(&#34;%Y-%m-%d %H:%M:%S%z&#34;)`</span><span class=w>
</span><span class=w></span><span class=nt>tags</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>$2]</span><span class=w>
</span><span class=w></span><span class=nt>categories</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>$3]</span><span class=w>
</span><span class=w></span><span class=nn>---</span><span class=w>
</span></code></pre></div><p>One minor issue with this snippet is that the date value keeps changing while
we are inside the snippet region<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, which is not desired. According to
<a href="https://www.youtube.com/watch?v=JJQYwt6Diro">tutorial here</a>, we can use Python
interpolation to deal with this issue.</p><h2 id=python-interpolation>Python interpolation</h2><p>Inside the Python interpolation code, Ultisnips provides the <code>snip</code> object. The
attribute <code>snip.c</code> is empty once the interpolation has finished. <code>snip.rv</code> is
the result for the snip interpolation.</p><p>We can check if <code>snip.c</code> is empty to fix the date once the interpolation code
is run for once.</p><p>The new <code>meta</code> snippet for Markdown now becomes:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=l>snippet &#34;meta&#34; &#34;Markdown metadata front matter&#34; b</span><span class=w>
</span><span class=w></span><span class=nn>---</span><span class=w>
</span><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;$1&#34;</span><span class=w>
</span><span class=w></span><span class=nt>date</span><span class=p>:</span><span class=w> </span><span class=l>`!p from datetime import datetime</span><span class=w>
</span><span class=w></span><span class=nt>if not snip.c</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=l>snip.rv=datetime.now().strftime(&#34;%Y-%m-%d %H:%M:%S%z&#34;)`</span><span class=w>
</span><span class=w></span><span class=nt>tags</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>$2]</span><span class=w>
</span><span class=w></span><span class=nt>categories</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>$3]</span><span class=w>
</span><span class=w></span><span class=nn>---</span><span class=w>
</span></code></pre></div><p>Now the date field will be fixed while we are editing other parts of the
snippet.</p><h1 id=references>References</h1><ul><li><a href="https://www.youtube.com/watch?v=JJQYwt6Diro">Ultisnips official tutorial.</a></li><li><a href=http://vimcasts.org/episodes/ultisnips-python-interpolation/>Vimcast on Ultisnips Python interpolation.</a></li></ul><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>The <code>b</code> flag says that this snippet can only be triggered at the begining of a line. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Because inside the snippet region, the interpolation code is run in real time and the result is updated to reflect the change. <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div><div class=post-copyright><p class=copyright-item><span class=item-title>Author</span>
<span class=item-content>jdhao</span></p><p class=copyright-item><span class=item-title>LastMod</span>
<span class=item-content>2020-04-25</span></p><p class=copyright-item><span class=item-title>License</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span></p></div><div class=post-reward><input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>Reward</label><div class=qr-code><label class=qr-code-image for=reward><img class=image src=https://blog-resource-1257868508.file.myqcloud.com/wechat.png>
<span>wechat</span></label>
<label class=qr-code-image for=reward><img class=image src=https://blog-resource-1257868508.file.myqcloud.com/zhifubao.jpg>
<span>alipay</span></label></div></div><footer class=post-footer><div class=post-tags><a href=/tags/Vim/>Vim</a>
<a href=/tags/Markdown/>Markdown</a>
<a href=/tags/snippet/>snippet</a></div><nav class=post-nav><a class=prev href=/2019/12/29/hugo_html_not_shown/><i class="iconfont icon-left"></i><span class="prev-text nav-default">Content inside HTML tags missing in Latest Hugo?</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=/2019/12/21/labelme_json_to_voc_xml/><span class="next-text nav-default">Labelme JSON 标注格式转 voc XML 格式</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname==='localhost')return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='jdhao';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href="https://stackoverflow.com/users/6064933/jdhao?tab=profile" class="iconfont icon-stack-overflow" title=stack-overflow></a><a href=https://github.com/jdhao class="iconfont icon-github" title=github></a><a href=https://jdhao.github.io/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span><div class=busuanzi-footer><span id=busuanzi_container_site_pv>site pv: <span id=busuanzi_value_site_pv><img src=/img/spinner.svg alt=spinner.svg></span></span>
<span class=division>|</span>
<span id=busuanzi_container_site_uv>site uv: <span id=busuanzi_value_site_uv><img src=/img/spinner.svg alt=spinner.svg></span></span></div><span class=copyright-year>&copy;
2017 -
2020<span class=heart><i class="iconfont icon-heart"></i></span><span>jdhao</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js></script><script type=text/javascript>window.MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],tags:'ams',}};</script><script async src=https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin=anonymous></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-113395108-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script id=baidu_push>(function(){if(window.location.hostname==='localhost')return;var bp=document.createElement('script');bp.async=true;var curProtocol=window.location.protocol.split(':')[0];if(curProtocol==='https'){bp.src='https://zz.bdstatic.com/linksubmit/push.js';}
else{bp.src='http://push.zhanzhang.baidu.com/push.js';}
var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script></body></html>