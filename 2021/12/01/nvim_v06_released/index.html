<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>Migration from Nvim 0.5.1 to Nvim 0.6.0 - jdhao's blog</title>
<meta name=renderer content="webkit">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1">
<meta http-equiv=cache-control content="no-transform">
<meta http-equiv=cache-control content="no-siteapp">
<meta name=theme-color content="#f8f5ec">
<meta name=msapplication-navbutton-color content="#f8f5ec">
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec">
<meta name=author content="jdhao"><meta name=description content="About five months ago, the biggest update of Nvim comes with its v0.5.0 release. With v0.5, we finally get the official LSP support in Nvim core and better Lua support, among other features and bug fixes1.
TL;DR: My LSP-related config can be found here.
"><meta name=keywords content="Hugo,theme,even">
<meta name=google-site-verification content="HTz0VHxqny_b0FfS774dICLBzHGBZCb_S11j_akF1Tw">
<meta name=generator content="Hugo 0.92.1 with theme even">
<link rel=canonical href=https://jdhao.github.io/2021/12/01/nvim_v06_released/>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png>
<link rel=manifest href=/manifest.json>
<link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5>
<script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<meta name=referrer content="no-referrer-when-downgrade"><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-6058871559165202",enable_page_level_ads:!0})</script>
<link href=/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css rel=stylesheet>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous>
<meta property="og:title" content="Migration from Nvim 0.5.1 to Nvim 0.6.0">
<meta property="og:description" content="About five months ago, the biggest update of Nvim comes with its v0.5.0
release. With v0.5, we finally get the official LSP support in Nvim core and
better Lua support, among other features and bug fixes1.
TL;DR: My LSP-related config can be found here.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://jdhao.github.io/2021/12/01/nvim_v06_released/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2021-12-01T22:25:30+08:00">
<meta property="article:modified_time" content="2021-12-12T16:38:32+08:00">
<meta itemprop=name content="Migration from Nvim 0.5.1 to Nvim 0.6.0">
<meta itemprop=description content="About five months ago, the biggest update of Nvim comes with its v0.5.0
release. With v0.5, we finally get the official LSP support in Nvim core and
better Lua support, among other features and bug fixes1.
TL;DR: My LSP-related config can be found here."><meta itemprop=datePublished content="2021-12-01T22:25:30+08:00">
<meta itemprop=dateModified content="2021-12-12T16:38:32+08:00">
<meta itemprop=wordCount content="371">
<meta itemprop=keywords content="LSP,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Migration from Nvim 0.5.1 to Nvim 0.6.0">
<meta name=twitter:description content="About five months ago, the biggest update of Nvim comes with its v0.5.0
release. With v0.5, we finally get the official LSP support in Nvim core and
better Lua support, among other features and bug fixes1.
TL;DR: My LSP-related config can be found here."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]-->
</head>
<body>
<div id=mobile-navbar class=mobile-navbar>
<div class=mobile-header-logo>
<a href=/ class=logo>jdhao's blog</a>
</div>
<div class=mobile-navbar-icon>
<span></span>
<span></span>
<span></span>
</div>
</div>
<nav id=mobile-menu class="mobile-menu slideout-menu">
<ul class=mobile-menu-list>
<a href=/>
<li class=mobile-menu-item>Home</li>
</a><a href=/post/>
<li class=mobile-menu-item>Archives</li>
</a><a href=/tags/>
<li class=mobile-menu-item>Tags</li>
</a><a href=/categories/>
<li class=mobile-menu-item>Categories</li>
</a><a href=/about/>
<li class=mobile-menu-item>About</li>
</a>
</ul>
</nav>
<div class=container id=mobile-panel>
<header id=header class=header>
<div class=logo-wrapper>
<a href=/ class=logo>jdhao's blog</a>
</div>
<nav class=site-navbar>
<ul id=menu class=menu>
<li class=menu-item>
<a class=menu-item-link href=/>Home</a>
</li><li class=menu-item>
<a class=menu-item-link href=/post/>Archives</a>
</li><li class=menu-item>
<a class=menu-item-link href=/tags/>Tags</a>
</li><li class=menu-item>
<a class=menu-item-link href=/categories/>Categories</a>
</li><li class=menu-item>
<a class=menu-item-link href=/about/>About</a>
</li>
</ul>
</nav>
</header>
<main id=main class=main>
<div class=content-wrapper>
<div id=content class=content>
<article class=post>
<header class=post-header>
<h1 class=post-title>Migration from Nvim 0.5.1 to Nvim 0.6.0</h1>
<div class=post-meta>
<span class=post-time> 2021-12-01 </span>
<div class=post-category>
<a href=/categories/Nvim/> Nvim </a>
</div>
<span class=more-meta> 371 words </span>
<span class=more-meta> 2 mins read </span>
<span id=busuanzi_container_page_pv class=more-meta> <span id=busuanzi_value_page_pv><img src=/img/spinner.svg alt=spinner.svg></span> times read </span>
</div>
</header>
<div class=post-toc id=post-toc>
<h2 class=post-toc-title>Contents</h2>
<div class=post-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#diagnostics-and-lsp-changes>Diagnostics and LSP changes</a></li>
<li><a href=#changes-to-the-default>Changes to the default</a></li>
</ul>
</nav>
</div>
</div>
<div class=post-content>
<p>About five months ago, the biggest update of Nvim comes with its <a href=https://github.com/neovim/neovim/releases/tag/v0.5.0>v0.5.0
release</a>. With v0.5, we finally get the official LSP support in Nvim core and
better Lua support, among other features and bug fixes<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p>
<p>TL;DR: My LSP-related config can be found <a href=https://github.com/jdhao/nvim-config/blob/master/lua/config/lsp.lua>here</a>.</p>
<p>This Tuesday, the Nvim <a href=https://github.com/neovim/neovim/releases/tag/v0.6.0>v0.6.0 version</a> is released. During the five
months, the LSP module has been revamped and enhanced, though with some breaking changes.</p>
<p>Below are some the changes we need or can make based on this release.</p>
<h1 id=diagnostics-and-lsp-changes>Diagnostics and LSP changes</h1>
<p>Initially, diagnostic module is part of <code>vim.lsp</code> module. In order to support
external plugins such as <a href=https://github.com/jose-elias-alvarez/null-ls.nvim>null-ls.nvim</a>, the nvim team has refactor the
diagnostic module to its module <code>vim.diagnostic</code>. So we need to change our config accordingly.</p>
<ol>
<li>
<p><code>vim.lsp.diagnostic.show_line_diagnostics()</code> has been changed to
<code>vim.diagnostic.open_float()</code>. Previously, there is no easy to show
diagnostic source unless with some hack, you can now show source in
diagnostics in <code>open_float()</code> easily:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=n>vim.diagnostic</span><span class=p>.</span><span class=n>open_float</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=p>{</span>
    <span class=n>source</span> <span class=o>=</span> <span class=s1>&#39;always&#39;</span>
<span class=p>})</span>
</code></pre></div></li>
<li>
<p><code>vim.lsp.diagnostic.goto_prev()</code> and <code>vim.lsp.diagnostic.goto_next()</code> has
been renamed to <code>vim.diagnostic.goto_prev()</code> and <code>vim.diagnostic.goto_next()</code>
respectively.</p>
</li>
<li>
<p><code>vim.lsp.diagnostic.set_loclist()</code> and <code>vim.lsp.diagnostic.set_qflist()</code>
has been renamed to <code>vim.diagnostic.setloclist()</code> and
<code>vim.diagnostic.setqflist()</code> instead.</p>
</li>
<li>
<p>Diagnostics signs has been renamed, for example (old &ndash;> new):</p>
<ul>
<li><code>LspDiagnosticsSignError</code> &ndash;> <code>DiagnosticSignError</code> (<code>Lsp</code> is removed, <code>Diagnostics</code> is changed to singular from <code>Diagnostic</code>)</li>
<li><code>LspDiagnosticsSignWarning</code> &ndash;> <code>DiagnosticSignWarn</code></li>
<li><code>LspDiagnosticsSignInformation</code> &ndash;> <code>DiagnosticSignInfo</code></li>
<li><code>LspDiagnosticsSignHint</code> &ndash;> <code>DiagnosticSignHint</code></li>
</ul>
<p>Also, related highlight has been renamed too:</p>
<ul>
<li><code>DiagnosticsDefaultError</code> &ndash;> <code>DiagnosticSignError</code></li>
<li><code>DiagnosticsDefaultWarning</code> &ndash;> <code>DiagnosticSignWarn</code></li>
<li><code>DiagnosticsDefaultInformation</code> &ndash;> <code>DiagnosticSignInfo</code></li>
<li><code>DiagnosticsDefaultHint</code> &ndash;> <code>DiagnosticSignHint</code></li>
</ul>
<p>Now, we can use the following lua snippet to change diagnostic signs:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=n>vim.fn</span><span class=p>.</span><span class=n>sign_define</span><span class=p>(</span><span class=s2>&#34;DiagnosticSignError&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=n>text</span> <span class=o>=</span> <span class=s2>&#34;✗&#34;</span><span class=p>,</span> <span class=n>texthl</span> <span class=o>=</span> <span class=s2>&#34;DiagnosticSignError&#34;</span> <span class=p>})</span>
<span class=n>vim.fn</span><span class=p>.</span><span class=n>sign_define</span><span class=p>(</span><span class=s2>&#34;DiagnosticSignWarn&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=n>text</span> <span class=o>=</span> <span class=s2>&#34;!&#34;</span><span class=p>,</span> <span class=n>texthl</span> <span class=o>=</span> <span class=s2>&#34;DiagnosticSignWarn&#34;</span> <span class=p>})</span>
<span class=n>vim.fn</span><span class=p>.</span><span class=n>sign_define</span><span class=p>(</span><span class=s2>&#34;DiagnosticSignInformation&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=n>text</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=n>texthl</span> <span class=o>=</span> <span class=s2>&#34;DiagnosticSignInfo&#34;</span> <span class=p>})</span>
<span class=n>vim.fn</span><span class=p>.</span><span class=n>sign_define</span><span class=p>(</span><span class=s2>&#34;DiagnosticSignHint&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=n>text</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=n>texthl</span> <span class=o>=</span> <span class=s2>&#34;DiagnosticSignHint&#34;</span> <span class=p>})</span>
</code></pre></div></li>
</ol>
<p>For more details on diagnostic change, see <a href=https://github.com/neovim/neovim/pull/15585/commits/a5bbb932f9094098bd656d3f6be3c58344576709>this commit</a>.</p>
<h1 id=changes-to-the-default>Changes to the default</h1>
<p>There are also changes to options and mappings that you might be interested.</p>
<p>Option default value changes:</p>
<ul>
<li><code>backupdir</code> can now be created automatically and double backslash is used, see <a href=https://github.com/neovim/neovim/commit/460019366e58e1bcd42959f76494e38bd895e762>this commit</a>.</li>
<li>option <code>inccommand</code> is set to <code>nosplit</code></li>
<li><code>set nojoinspaces</code> by default</li>
</ul>
<p>Mapping changes:</p>
<ul>
<li><code>&lt;C-L></code> now defaults to <code>nohlsearch</code> and <code>diffupdate</code>, see <a href=https://github.com/neovim/neovim/commit/0aa8128aaa9e6f714372f7ea7299f4115de0a962>this commit</a>.</li>
<li>In normal mode, <code>Y</code> is mapped to <code>y$</code>, see <a href=https://github.com/neovim/neovim/commit/5a111c1b02bbfbc2b42df11d7205153be0893dff>this commit</a>, no need for <code>nnoremap Y y$</code> anymore.</li>
</ul>
<section class=footnotes role=doc-endnotes>
<hr>
<ol>
<li id=fn:1 role=doc-endnote>
<p>The nvim 0.5 release note is <a href=https://github.com/neovim/neovim/commit/a5ac2f45ff84a688a09479f357a9909d5b914294>here</a>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
</ol>
</section>
</div>
<div class=post-copyright>
<p class=copyright-item>
<span class=item-title>Author</span>
<span class=item-content>jdhao</span>
</p>
<p class=copyright-item>
<span class=item-title>LastMod</span>
<span class=item-content>
2021-12-12
</span>
</p>
<p class=copyright-item>
<span class=item-title>License</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span>
</p>
</div>
<div class=post-reward>
<input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>Reward</label>
<div class=qr-code>
<label class=qr-code-image for=reward>
<img class=image src=https://blog-resource-1257868508.file.myqcloud.com/wechat.png>
<span>wechat</span>
</label>
<label class=qr-code-image for=reward>
<img class=image src=https://blog-resource-1257868508.file.myqcloud.com/zhifubao.jpg>
<span>alipay</span>
</label>
</div>
</div><footer class=post-footer>
<div class=post-tags>
<a href=/tags/LSP/>LSP</a>
</div>
<nav class=post-nav>
<a class=prev href=/2021/12/12/ipad_shadowrocket_install/>
<i class="iconfont icon-left"></i>
<span class="prev-text nav-default">【2021 年】iPad 安装 Shadowrocket</span>
<span class="prev-text nav-mobile">Prev</span>
</a>
<a class=next href=/2021/11/28/how_i_write_blog/>
<span class="next-text nav-default">How I Manage My Personal Blog</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i>
</a>
</nav>
</footer>
</article>
</div>
<script src=https://utteranc.es/client.js repo=jdhao/jdhao.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script>
<noscript>Please enable JavaScript to view the <a href=https://github.com/utterance>comments powered by utterances.</a></noscript>
</div>
</main>
<footer id=footer class=footer>
<div class=social-links>
<a href="https://stackoverflow.com/users/6064933/jdhao?tab=profile" class="iconfont icon-stack-overflow" title=stack-overflow></a>
<a href=https://github.com/jdhao class="iconfont icon-github" title=github></a>
<a href=https://jdhao.github.io/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a>
</div>
<div class=copyright>
<span class=power-by>
Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a>
</span>
<span class=division>|</span>
<span class=theme-info>
Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a>
</span>
<div class=busuanzi-footer>
<span id=busuanzi_container_site_pv> site pv: <span id=busuanzi_value_site_pv><img src=/img/spinner.svg alt=spinner.svg></span> </span>
<span class=division>|</span>
<span id=busuanzi_container_site_uv> site uv: <span id=busuanzi_value_site_uv><img src=/img/spinner.svg alt=spinner.svg></span> </span>
</div>
<span class=copyright-year>
&copy;
2017 -
2022<span class=heart><i class="iconfont icon-heart"></i></span><span>jdhao</span>
</span>
</div>
</footer>
<div class=back-to-top id=back-to-top>
<i class="iconfont icon-up"></i>
</div>
</div>
<script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js></script>
<script type=text/javascript>window.MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],tags:'ams'}}</script>
<script async src=https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-113395108-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<script id=baidu_push>(function(){var a,c,b;if(window.location.hostname==='localhost')return;a=document.createElement('script'),a.async=!0,c=window.location.protocol.split(':')[0],c==='https'?a.src='https://zz.bdstatic.com/linksubmit/push.js':a.src='http://push.zhanzhang.baidu.com/push.js',b=document.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b)})()</script>
</body>
</html>