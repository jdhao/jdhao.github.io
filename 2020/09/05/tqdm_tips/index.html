<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Tqdm Issues and Tips - jdhao's blog</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="jdhao"><meta name=description content="Tqdm is a popular package to show a progress bar. Here are a few tips when using tqdm."><meta name=keywords content="Hugo,theme,even"><meta name=google-site-verification content="HTz0VHxqny_b0FfS774dICLBzHGBZCb_S11j_akF1Tw"><meta name=generator content="Hugo 0.75.1 with theme even"><link rel=canonical href=https://jdhao.github.io/2020/09/05/tqdm_tips/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta name=referrer content="no-referrer-when-downgrade"><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-6058871559165202",enable_page_level_ads:true});</script><link href=/sass/main.min.c7bc1becf36bcf6a9ebd25d2947e43a2eb745ddb0c9a32b43126fd7fa460c351.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:title" content="Tqdm Issues and Tips"><meta property="og:description" content="Tqdm is a popular package to show a progress
bar. Here are a few tips when using tqdm."><meta property="og:type" content="article"><meta property="og:url" content="https://jdhao.github.io/2020/09/05/tqdm_tips/"><meta property="article:published_time" content="2020-09-05T00:23:28+08:00"><meta property="article:modified_time" content="2020-12-28T21:42:28+08:00"><meta itemprop=name content="Tqdm Issues and Tips"><meta itemprop=description content="Tqdm is a popular package to show a progress
bar. Here are a few tips when using tqdm."><meta itemprop=datePublished content="2020-09-05T00:23:28+08:00"><meta itemprop=dateModified content="2020-12-28T21:42:28+08:00"><meta itemprop=wordCount content="323"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Tqdm Issues and Tips"><meta name=twitter:description content="Tqdm is a popular package to show a progress
bar. Here are a few tips when using tqdm."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>jdhao's blog</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Home</li></a><a href=/post/><li class=mobile-menu-item>Archives</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a><a href=/categories/><li class=mobile-menu-item>Categories</li></a><a href=/about/><li class=mobile-menu-item>About</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>jdhao's blog</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=/categories/>Categories</a></li><li class=menu-item><a class=menu-item-link href=/about/>About</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Tqdm Issues and Tips</h1><div class=post-meta><span class=post-time>2020-09-05</span><div class=post-category><a href=/categories/Python/>Python</a></div><span class=more-meta>323 words</span>
<span class=more-meta>2 mins read</span>
<span id=busuanzi_container_page_pv class=more-meta><span id=busuanzi_value_page_pv><img src=/img/spinner.svg alt=spinner.svg></span> times read</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class=post-toc-content><nav id=TableOfContents><ul><li><a href=#windows-display-issue>Windows display issue</a></li><li><a href=#iterate-over-each-line-in-a-file-and-show-progress>Iterate over each line in a file and show progress?</a></li><li><a href=#show-progress-for-concurrentfuturesthreadpoolexecutor>Show progress for concurrent.futures.ThreadPoolExecutor</a></li></ul></nav></div></div><div class=post-content><p><a href=https://github.com/tqdm/tqdm>Tqdm</a> is a popular package to show a progress
bar. Here are a few tips when using tqdm.</p><h1 id=windows-display-issue>Windows display issue</h1><p>On Windows, it seems that tqdm will print a new line when showing the progress,
which is annoying.</p><p>According to issue <a href=https://github.com/tqdm/tqdm/issues/454>here</a>, this is due
to buggy Unicode handling in Windows terminal. We can add <code>ascii=True</code> in
<code>tqdm()</code> to prevent this behavior. Works for me on Windows for both Cmder and
plain cmd.</p><h1 id=iterate-over-each-line-in-a-file-and-show-progress>Iterate over each line in a file and show progress?</h1><p>When we are processing files with large number of lines, we may want to see the
progress. To see the progress, we need to know the number of lines in this
file. Here is a sample code to show the progress bar using tqdm:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=kn>from</span> <span class=nn>tqdm</span> <span class=kn>import</span> <span class=n>tqdm</span>

<span class=n>file_path</span> <span class=o>=</span> <span class=s2>&#34;test.txt&#34;</span>
<span class=n>num_lines</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=mi>1</span> <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=nb>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>))</span>

<span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
    <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>total</span><span class=o>=</span><span class=n>num_lines</span><span class=p>):</span>
        <span class=c1># deal with this line...</span>
        <span class=k>pass</span>
</code></pre></div><p>Ref</p><ul><li><a href=https://stackoverflow.com/q/48437189/6064933>python enumerate tqdm bar when reading a file?</a></li></ul><h1 id=show-progress-for-concurrentfuturesthreadpoolexecutor>Show progress for concurrent.futures.ThreadPoolExecutor</h1><p>Here is an example of using tqdm together with concurrent.futures:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=kn>from</span> <span class=nn>concurrent.futures</span> <span class=kn>import</span> <span class=n>ThreadPoolExecutor</span>
<span class=kn>import</span> <span class=nn>time</span>

<span class=kn>from</span> <span class=nn>tqdm</span> <span class=kn>import</span> <span class=n>tqdm</span>


<span class=k>def</span> <span class=nf>square</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.01</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>x</span><span class=o>*</span><span class=n>x</span>


<span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
    <span class=n>nums</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>))</span>
    <span class=k>with</span> <span class=n>ThreadPoolExecutor</span><span class=p>()</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
        <span class=n>results</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>tqdm</span><span class=p>(</span><span class=n>executor</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>square</span><span class=p>,</span> <span class=n>nums</span><span class=p>),</span> <span class=n>total</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>nums</span><span class=p>)))</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
    <span class=n>main</span><span class=p>()</span>
</code></pre></div><p>The output of <code>executor.map(square, nums)</code> is a generator containing all the
returned results from the function <code>square()</code>. So we need to supply the total
number in the <code>total</code> argument.</p><p>In the latest version of tqdm, we can also simplify the above code by using
<code>tqdm.contrib.concurrent.thread_map()</code> method, which is essentially a wrapper
around above code:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=kn>from</span> <span class=nn>concurrent.futures</span> <span class=kn>import</span> <span class=n>ThreadPoolExecutor</span>
<span class=kn>import</span> <span class=nn>time</span>

<span class=kn>from</span> <span class=nn>tqdm.contrib.concurrent</span> <span class=kn>import</span> <span class=n>thread_map</span>


<span class=k>def</span> <span class=nf>square</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.01</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>x</span><span class=o>*</span><span class=n>x</span>


<span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
    <span class=n>nums</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>))</span>
    <span class=k>with</span> <span class=n>ThreadPoolExecutor</span><span class=p>()</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
        <span class=n>results</span> <span class=o>=</span> <span class=n>thread_map</span><span class=p>(</span><span class=n>square</span><span class=p>,</span> <span class=n>nums</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
    <span class=n>main</span><span class=p>()</span>
</code></pre></div><p>The above code is tested on tqdm version 4.48.2.</p><p>Ref:</p><ul><li><a href=https://stackoverflow.com/a/52242947/6064933>Use tqdm with concurrent.futures?</a></li><li>Another way: <a href=https://gist.github.com/alexeygrigorev/79c97c1e9dd854562df9bbeea76fc5de>https://gist.github.com/alexeygrigorev/79c97c1e9dd854562df9bbeea76fc5de</a></li><li><a href=https://tqdm.github.io/docs/contrib.concurrent/#tqdmcontribconcurrent>doc on tqdm.contrib.concurrent</a>.</li></ul></div><div class=post-copyright><p class=copyright-item><span class=item-title>Author</span>
<span class=item-content>jdhao</span></p><p class=copyright-item><span class=item-title>LastMod</span>
<span class=item-content>2020-12-28</span></p><p class=copyright-item><span class=item-title>License</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span></p></div><div class=post-reward><input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>Reward</label><div class=qr-code><label class=qr-code-image for=reward><img class=image src=https://blog-resource-1257868508.file.myqcloud.com/wechat.png>
<span>wechat</span></label>
<label class=qr-code-image for=reward><img class=image src=https://blog-resource-1257868508.file.myqcloud.com/zhifubao.jpg>
<span>alipay</span></label></div></div><footer class=post-footer><nav class=post-nav><a class=prev href=/2020/09/14/git_find_line_history/><i class="iconfont icon-left"></i><span class="prev-text nav-default">Find Line History in Git</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=/2020/09/03/git_branch_operations/><span class="next-text nav-default">Git branches</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname==='localhost')return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='jdhao';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href="https://stackoverflow.com/users/6064933/jdhao?tab=profile" class="iconfont icon-stack-overflow" title=stack-overflow></a><a href=https://github.com/jdhao class="iconfont icon-github" title=github></a><a href=https://jdhao.github.io/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span><div class=busuanzi-footer><span id=busuanzi_container_site_pv>site pv: <span id=busuanzi_value_site_pv><img src=/img/spinner.svg alt=spinner.svg></span></span>
<span class=division>|</span>
<span id=busuanzi_container_site_uv>site uv: <span id=busuanzi_value_site_uv><img src=/img/spinner.svg alt=spinner.svg></span></span></div><span class=copyright-year>&copy;
2017 -
2021<span class=heart><i class="iconfont icon-heart"></i></span><span>jdhao</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js></script><script type=text/javascript>window.MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],tags:'ams',}};</script><script async src=https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin=anonymous></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-113395108-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script id=baidu_push>(function(){if(window.location.hostname==='localhost')return;var bp=document.createElement('script');bp.async=true;var curProtocol=window.location.protocol.split(':')[0];if(curProtocol==='https'){bp.src='https://zz.bdstatic.com/linksubmit/push.js';}
else{bp.src='http://push.zhanzhang.baidu.com/push.js';}
var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script></body></html>